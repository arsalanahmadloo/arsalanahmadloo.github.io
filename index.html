<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù…</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { direction: rtl; background: #f8f9fa; font-family: Tahoma; }
    .container { max-width: 800px; margin-top: 50px; }
    .card { border-radius: 15px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); }
    .card-header { font-weight: bold; font-size: 18px; }
    footer { margin-top: 50px; text-align: center; font-size: 14px; color: gray; }
  </style>
</head>
<body>

<div class="container">
  <h1 class="text-center mb-4">ğŸŒ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù…</h1>

  <!-- ØªÙ†Ø¸ÛŒÙ… ØªÙˆÚ©Ù† -->
  <div class="card mb-4">
    <div class="card-header bg-primary text-white">ØªÙ†Ø¸ÛŒÙ… ØªÙˆÚ©Ù†</div>
    <div class="card-body">
      <input type="text" id="token" class="form-control mb-2" placeholder="ØªÙˆÚ©Ù† Ø±Ø¨Ø§Øª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
      <button class="btn btn-success w-100" onclick="setToken()">Ø°Ø®ÛŒØ±Ù‡ ØªÙˆÚ©Ù†</button>
      <div id="resultToken" class="mt-2 text-success fw-bold"></div>
    </div>
  </div>

  <!-- Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… -->
  <div class="card mb-4" id="msgBox" style="display:none;">
    <div class="card-header bg-secondary text-white">Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…</div>
    <div class="card-body">
      <input type="text" id="chatId" class="form-control mb-2" placeholder="Ø¢ÛŒØ¯ÛŒ Ø¹Ø¯Ø¯ÛŒ ÛŒØ§ ÛŒÙˆØ²Ø±Ù†ÛŒÙ…">
      <textarea id="message" class="form-control mb-2" placeholder="Ù…ØªÙ† Ù¾ÛŒØ§Ù…"></textarea>
      <button class="btn btn-dark w-100" onclick="sendMessage()">Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…</button>
      <div id="resultMessage" class="mt-2 text-primary fw-bold"></div>
    </div>
  </div>

  <!-- Ú©Ø§Ø±Ø¨Ø±Ø§Ù† -->
  <div class="card mb-4" id="userBox" style="display:none;">
    <div class="card-header bg-info text-white">Ù„ÛŒØ³Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</div>
    <div class="card-body">
      <ul id="userList" class="list-group"></ul>
    </div>
  </div>

</div>

<footer>Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø¨Ø§ â¤ï¸ Ø¨Ø±Ø§ÛŒ Ø§Ø±Ú©Ú©</footer>

<script>
  // Ø¢Ø¯Ø±Ø³ Ø¨Ú©â€ŒØ§Ù†Ø¯ (API) Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ø±ÙˆÛŒ Render ÛŒØ§ VPS Ø±Ø§Ù† Ú©Ù†ÛŒ
  let apiBase = "https://your-backend-url.onrender.com";

  function setToken() {
    let token = document.getElementById("token").value;
    fetch(apiBase + "/set_token", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ token: token })
    })
    .then(res => res.json())
    .then(data => {
      document.getElementById("resultToken").innerText = data.message;
      if (data.status === "ok") {
        document.getElementById("msgBox").style.display = "block";
        document.getElementById("userBox").style.display = "block";
        loadUsers();
      }
    })
    .catch(() => alert("âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„"));
  }

  function sendMessage() {
    let chatId = document.getElementById("chatId").value;
    let message = document.getElementById("message").value;
    fetch(apiBase + "/send_message", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ chat_id: chatId, text: message })
    })
    .then(res => res.json())
    .then(data => {
      document.getElementById("resultMessage").innerText = data.message;
    });
  }

  function loadUsers() {
    fetch(apiBase + "/users")
    .then(res => res.json())
    .then(users => {
      let list = document.getElementById("userList");
      list.innerHTML = "";
      users.forEach(u => {
        let li = document.createElement("li");
        li.className = "list-group-item";
        li.innerText = u.username + " (" + u.chat_id + ")";
        list.appendChild(li);
      });
    });
  }
</script>

</body>
</html>
